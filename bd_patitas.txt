CREATE TABLE Usuarios (
    Id_Usuario INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    Usuario VARCHAR(12) NOT NULL,
    Correo VARCHAR (80) NOT NULL,
    Contrasena VARCHAR(255) NOT NULL,
    Rol INT NOT NULL,
    CambioContra TINYINT,
    FechaCambioContra DATETIME
);

CREATE TABLE HistorialContrasenas (
    Id_Historial INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    Id_Usuario INT NOT NULL,
    FechaCambio DATETIME,
    Contrasena VARCHAR(20),
    FOREIGN KEY (Id_Usuario) REFERENCES Usuarios(Id_Usuario)
);

CREATE TABLE Imagen(
    Id_Imagen INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    Nombre VARCHAR(50),
    URL VARCHAR(255)
);

CREATE TABLE Productos (
    Id_Producto INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    Nombre VARCHAR(100),
    Cantidad INT,
    Descripcion VARCHAR(255),
    Categoria VARCHAR(50),
    Precio DECIMAL (65, 2),
    Id_Imagen INT NOT NULL,
    Token VARCHAR(6),
    TokenVencimiento DATETIME,
    FOREIGN KEY (Id_Imagen) REFERENCES Imagen(Id_Imagen)
);

CREATE TABLE Carrito (
    Id_Carrito INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    Id_Imagen INT NOT NULL,
    Id_Producto INT NOT NULL,
    FOREIGN KEY (Id_Imagen) REFERENCES Imagen(Id_Imagen),
    FOREIGN KEY (Id_Producto) REFERENCES Productos(Id_Producto)
);

CREATE TABLE Rol (
    idRol INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL UNIQUE,
    descripcion VARCHAR(150)
);

CREATE TABLE Permiso (
    idPermiso INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50) NOT NULL UNIQUE,
    descripcion VARCHAR(150)
);

CREATE TABLE Rol_Permisos (
    idRol INT NOT NULL,
    idPermiso INT NOT NULL,
    PRIMARY KEY (idRol, idPermiso),
    FOREIGN KEY (idRol) REFERENCES Rol(idRol),
    FOREIGN KEY (idPermiso) REFERENCES Permiso(idPermiso)
);



